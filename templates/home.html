<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Projet2 - Images</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

    <header>
        <h1>Galerie</h1>
    </header>

    <div class="layout">

        <!-- MENU GAUCHE -->
        <aside class="sidebar">
            <h2>Réglages</h2>

            {% if folders %}
            <form method="GET" action="/">

                <!-- Choix du dossier -->
                <label for="folder">Dossier</label>
                <select id="folder" name="folder" onchange="this.form.submit()">
                    {% for f in folders %}
                    <option value="{{ f }}" {% if f==folder %}selected{% endif %}>
                        {{ f }}
                    </option>
                    {% endfor %}
                </select>

                <!-- Choix image -->
                <label for="img" style="margin-top: 1rem;">Image</label>
                <select id="img" name="img">
                    {% for img in images %}
                    <option value="{{ img }}" {% if img==selected %}selected{% endif %}>
                        {{ img }}
                    </option>
                    {% endfor %}
                </select>

                <!-- Choix algorithme -->
                <label for="algo" style="margin-top: 1rem;">Algorithme</label>
                <select id="algo" name="algo">
                    <option value="original" {% if algo=="original" %}selected{% endif %}>
                        Original
                    </option>
                    <option value="kmeans" {% if algo=="kmeans" %}selected{% endif %}>
                        KMeans (couleurs)
                    </option>
                    <option value="hclust" {% if algo=="hclust" %}selected{% endif %}>
                        HClust (hiérarchique)
                    </option>
                </select>

                <!-- Nombre K -->
                <label for="k" style="margin-top: 1rem;">Nombre K</label>
                <input type="number" id="k" name="k" min="2" max="32" value="{{ k }}">

                <button type="submit" style="margin-top: 1rem;">
                    Appliquer
                </button>

            </form>
            {% else %}
            <p class="muted">Aucun dossier trouvé.</p>
            {% endif %}

        </aside>

        <!-- AFFICHAGE IMAGE -->
        <main class="content">
            <h2>Affichage</h2>

            {% if display_image and folder %}
            <div class="viewer">
                <img src="{{ url_for('photo') }}?folder={{ folder }}&img={{ display_image }}" alt="Image sélectionnée">

                <p class="caption">
                    {{ selected }}
                    — <strong>{{ algo }}</strong>
                    {% if algo == "kmeans" %} (K={{ k }}){% endif %}
                    {% if algo == "hclust" %} (K={{ k }}){% endif %}
                </p>
            </div>
            {% else %}
            <p class="muted">Aucune image à afficher.</p>
            {% endif %}

        </main>

    </div>

</body>

</html>